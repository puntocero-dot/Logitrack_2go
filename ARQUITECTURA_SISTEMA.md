# ğŸ—ï¸ LOGITRACK - Arquitectura del Sistema

## ğŸ“Š VisiÃ³n General

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           LOGITRACK PLATFORM                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Web App    â”‚  â”‚ Client View â”‚  â”‚ Coord App   â”‚  â”‚ Driver App  â”‚   â”‚
â”‚  â”‚  (React)    â”‚  â”‚  (React)    â”‚  â”‚  (React)    â”‚  â”‚  (React)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                â”‚                â”‚                â”‚           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                   â”‚                                     â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚                          â”‚   API Gateway   â”‚ â† Rate Limiting, CORS     â”‚
â”‚                          â”‚   (Go + Gin)    â”‚   Auth, Logging           â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                   â”‚                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚    â”‚                              â”‚                              â”‚     â”‚
â”‚  â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”  â”‚
â”‚  â”‚  User    â”‚  â”‚         Order Service             â”‚  â”‚Integration â”‚  â”‚
â”‚  â”‚ Service  â”‚  â”‚  â€¢ Orders  â€¢ Motos  â€¢ Branches    â”‚  â”‚  Service   â”‚  â”‚
â”‚  â”‚  (Go)    â”‚  â”‚  â€¢ Routes  â€¢ KPIs  â€¢ Visits       â”‚  â”‚   (Go)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                         â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ AI Serviceâ”‚          â”‚   PostgreSQL    â”‚                           â”‚
â”‚  â”‚ (Python)  â”‚          â”‚  (Persistence)  â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¢ Modelo de Sucursales (CRÃTICO)

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         LOGITRACK               â”‚
                    â”‚   (Multi-Sucursal / Multi-Tenant)â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                            â”‚                            â”‚
        â–¼                            â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SUCURSAL A   â”‚          â”‚  SUCURSAL B   â”‚          â”‚  SUCURSAL C   â”‚
â”‚   (Central)   â”‚          â”‚  (Zona Norte) â”‚          â”‚  (Zona Sur)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               â”‚          â”‚               â”‚          â”‚               â”‚
â”‚ ğŸ‘¤ Usuarios   â”‚          â”‚ ğŸ‘¤ Usuarios   â”‚          â”‚ ğŸ‘¤ Usuarios   â”‚
â”‚  - Supervisor â”‚          â”‚  - Supervisor â”‚          â”‚  - Supervisor â”‚
â”‚  - Analista   â”‚          â”‚  - Drivers    â”‚          â”‚  - Drivers    â”‚
â”‚               â”‚          â”‚               â”‚          â”‚               â”‚
â”‚ ğŸï¸ Motos     â”‚          â”‚ ğŸï¸ Motos     â”‚          â”‚ ğŸï¸ Motos     â”‚
â”‚  - MOTO-001   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  - MOTO-004   â”‚          â”‚  - MOTO-007   â”‚
â”‚  - MOTO-002   â”‚Transferirâ”‚  - MOTO-005   â”‚          â”‚  - MOTO-008   â”‚
â”‚  - MOTO-003   â”‚ temporal â”‚  - MOTO-006   â”‚          â”‚  - MOTO-009   â”‚
â”‚               â”‚          â”‚               â”‚          â”‚               â”‚
â”‚ ğŸ“¦ Pedidos    â”‚          â”‚ ğŸ“¦ Pedidos    â”‚          â”‚ ğŸ“¦ Pedidos    â”‚
â”‚  (Solo suyos) â”‚          â”‚  (Solo suyos) â”‚          â”‚  (Solo suyos) â”‚
â”‚               â”‚          â”‚               â”‚          â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â–²                            â–²                            â–²
        â”‚                            â”‚                            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     ROLES CON VISTA GLOBAL      â”‚
                    â”‚  â€¢ Admin (ve todo)              â”‚
                    â”‚  â€¢ Gerente (ve todas las KPIs)  â”‚
                    â”‚  â€¢ Coordinador (visita todas)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Reglas de Aislamiento por Sucursal:

| Rol | Alcance de Vista | Puede Transferir Motos |
|-----|------------------|------------------------|
| **Admin** | Todas las sucursales | âœ… SÃ­ |
| **Gerente** | Todas las sucursales (solo lectura) | âŒ No |
| **Coordinador** | Todas las sucursales (visitas) | âŒ No |
| **Supervisor** | Solo SU sucursal | âœ… SÃ­ (a otra sucursal) |
| **Analista** | Solo SU sucursal | âŒ No |
| **Driver** | Solo SUS pedidos asignados | âŒ No |

---

## ğŸ‘¥ JerarquÃ­a Organizacional

```
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚    ADMIN     â”‚ â† ConfiguraciÃ³n global
                         â”‚  (Sistema)   â”‚   Todos los accesos
                         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                 â”‚                 â”‚
              â–¼                 â–¼                 â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    GERENTE     â”‚ â”‚ COORDINADOR  â”‚ â”‚    ANALISTA      â”‚
     â”‚  (LogÃ­stica)   â”‚ â”‚   (Visitas)  â”‚ â”‚    (Reportes)    â”‚
     â”‚                â”‚ â”‚              â”‚ â”‚                  â”‚
     â”‚ â€¢ KPIs globalesâ”‚ â”‚ â€¢ Check-in   â”‚ â”‚ â€¢ Alertas        â”‚
     â”‚ â€¢ Overview     â”‚ â”‚ â€¢ Checklist  â”‚ â”‚ â€¢ PredicciÃ³n     â”‚
     â”‚ â€¢ Comparativos â”‚ â”‚ â€¢ AuditorÃ­as â”‚ â”‚ â€¢ Balanceo       â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Supervisa
              â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                  SUCURSAL X                     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                                                 â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
     â”‚    â”‚  SUPERVISOR  â”‚ â† Gestiona operaciones      â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   de SU sucursal            â”‚
     â”‚           â”‚                                     â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
     â”‚    â”‚              â”‚                             â”‚
     â”‚    â–¼              â–¼                             â”‚
     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”             â”‚
     â”‚ â”‚MOTO 1â”‚     â”‚MOTO 2â”‚     â”‚MOTO 3â”‚             â”‚
     â”‚ â”‚Driverâ”‚     â”‚Driverâ”‚     â”‚Driverâ”‚             â”‚
     â”‚ â””â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”˜             â”‚
     â”‚                                                 â”‚
     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
     â”‚ â”‚           PEDIDOS DE LA SUCURSAL         â”‚   â”‚
     â”‚ â”‚  â€¢ Pedido 101  â€¢ Pedido 102  â€¢ Pedido 103â”‚   â”‚
     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
     â”‚                                                 â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flujo de Transferencia de Motos

```
ESCENARIO: Sucursal A tiene muchos pedidos, Sucursal B tiene motos libres

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SUCURSAL A  â”‚                              â”‚ SUCURSAL B  â”‚
â”‚             â”‚                              â”‚             â”‚
â”‚ ğŸï¸ MOTO-001 â”‚                              â”‚ ğŸï¸ MOTO-004 â”‚
â”‚ ğŸï¸ MOTO-002 â”‚                              â”‚ ğŸï¸ MOTO-005 â”‚ â† Libre
â”‚             â”‚                              â”‚ ğŸï¸ MOTO-006 â”‚ â† Libre
â”‚ ğŸ“¦ 15 pedidosâ”‚                              â”‚ ğŸ“¦ 2 pedidos â”‚
â”‚    pendientesâ”‚                              â”‚    pendientesâ”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                            â”‚
       â”‚  Supervisor A solicita apoyo               â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                                            â”‚
       â”‚        Admin/Gerente autoriza              â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
       â”‚                                            â”‚
       â”‚     MOTO-005 transferida temporalmente     â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                                            â”‚
       â–¼                                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SUCURSAL A  â”‚                              â”‚ SUCURSAL B  â”‚
â”‚             â”‚                              â”‚             â”‚
â”‚ ğŸï¸ MOTO-001 â”‚                              â”‚ ğŸï¸ MOTO-004 â”‚
â”‚ ğŸï¸ MOTO-002 â”‚                              â”‚ ğŸï¸ MOTO-006 â”‚
â”‚ ğŸï¸ MOTO-005 â”‚ â† Temporal                   â”‚             â”‚
â”‚   (de B)    â”‚                              â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

* Al finalizar el turno, MOTO-005 regresa a Sucursal B
```

---

## ğŸ“‹ Modelo de Datos Actualizado

```sql
-- Usuarios pertenecen a una sucursal
users (
  id, name, email, role, 
  branch VARCHAR(50) â† Sucursal asignada ('central', 'norte', etc.)
)

-- Motos pertenecen a una sucursal
motos (
  id, license_plate, driver_id,
  branch_id INTEGER â† Sucursal home (dÃ³nde normalmente opera)
  current_branch_id INTEGER â† Sucursal actual (puede ser diferente si estÃ¡ transferido)
  transfer_expires_at TIMESTAMP â† CuÃ¡ndo termina la transferencia temporal
)

-- Pedidos pertenecen a una sucursal
orders (
  id, client_name, address, status,
  branch VARCHAR(50) â† Sucursal que gestiona este pedido
)

-- Sucursales con geolocalizaciÃ³n
branches (
  id, name, code, latitude, longitude, radius_km
)
```

---

## ğŸ” Filtros de Seguridad por Sucursal

### Backend (order-service):

```go
// Al obtener pedidos, filtrar por sucursal del usuario
func GetOrders(c *gin.Context) {
    userBranch := c.GetHeader("X-User-Branch")
    userRole := c.GetHeader("X-User-Role")
    
    query := "SELECT * FROM orders"
    
    // Solo admin/gerente ven todas las sucursales
    if userRole != "admin" && userRole != "manager" {
        query += " WHERE branch = '" + userBranch + "'"
    }
    // ...
}
```

### Frontend (React):

```javascript
// El usuario solo ve opciones de SU sucursal
const orders = userRole === 'admin' 
  ? allOrders 
  : allOrders.filter(o => o.branch === userBranch);
```

---

## ğŸš€ Siguiente ImplementaciÃ³n Necesaria

1. **Agregar `current_branch_id` a motos** para transferencias
2. **Filtrar queries por branch del usuario**
3. **Endpoint de transferencia temporal**
4. **UI para solicitar/aprobar transferencias**

Â¿Deseas que implemente estos cambios ahora?
